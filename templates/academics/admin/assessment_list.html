{% extends 'base.html' %}
{% load static %}

{% block title %}Assessment Management{% endblock %}

{% block extra_css %}
<style>
    /* Page Header */
    .page-header {
        background: linear-gradient(135deg, rgba(123, 44, 191, 0.1), rgba(74, 144, 226, 0.1));
        padding: 40px 0;
        margin-bottom: 30px;
        border-radius: 0 0 50px 50px;
        position: relative;
        overflow: hidden;
    }

    .page-header::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200px;
        height: 200px;
        background: linear-gradient(135deg, var(--primary-pink), var(--secondary-pink));
        border-radius: 50%;
        opacity: 0.1;
        animation: float 15s ease-in-out infinite;
    }

    .page-header::after {
        content: '';
        position: absolute;
        bottom: -50%;
        left: -50%;
        width: 300px;
        height: 300px;
        background: linear-gradient(135deg, var(--secondary-pink), var(--primary-pink));
        border-radius: 50%;
        opacity: 0.1;
        animation: float 20s ease-in-out infinite reverse;
    }

    .page-title {
        font-family: 'Playfair Display', serif;
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        position: relative;
        z-index: 2;
    }

    .page-breadcrumb {
        background: transparent;
        padding: 0;
        margin: 0;
        position: relative;
        z-index: 2;
    }

    .page-breadcrumb .breadcrumb-item {
        color: var(--text-secondary);
        font-weight: 500;
    }

    .page-breadcrumb .breadcrumb-item a {
        color: var(--primary-pink);
        text-decoration: none;
        transition: var(--transition-smooth);
    }

    .page-breadcrumb .breadcrumb-item a:hover {
        color: var(--dark-pink);
        transform: translateX(5px);
    }

    /* Filter Card */
    .filter-card {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border: var(--border);
        border-radius: 20px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: var(--shadow);
        transition: var(--transition-bounce);
        position: relative;
        overflow: hidden;
    }

    .filter-card::before {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 150px;
        height: 150px;
        background: linear-gradient(135deg, var(--primary-pink), var(--secondary-pink));
        opacity: 0.1;
        border-radius: 0 0 0 100%;
    }

    .filter-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(123, 44, 191, 0.2);
    }

    .filter-title {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 20px;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .filter-title i {
        color: var(--primary-pink);
        font-size: 1.5rem;
    }

    .filter-form .form-group {
        margin-bottom: 15px;
    }

    .filter-form label {
        font-weight: 500;
        color: var(--text-primary);
        margin-bottom: 5px;
        display: block;
    }

    .filter-form .form-control,
    .filter-form .form-select {
        background: var(--card-bg);
        border: var(--border);
        border-radius: 15px;
        padding: 10px 15px;
        color: var(--text-primary);
        transition: var(--transition-smooth);
    }

    .filter-form .form-control:focus,
    .filter-form .form-select:focus {
        border-color: var(--primary-pink);
        box-shadow: 0 0 0 0.2rem rgba(123, 44, 191, 0.25);
        transform: translateY(-2px);
    }

    .filter-actions {
        display: flex;
        gap: 10px;
        margin-top: 20px;
    }

    /* Action Bar */
    .action-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        flex-wrap: wrap;
        gap: 15px;
    }

    .action-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .btn-action {
        padding: 12px 25px;
        border-radius: 50px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: var(--transition-bounce);
        position: relative;
        overflow: hidden;
    }

    .btn-action::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
        z-index: -1;
    }

    .btn-action:hover::before {
        width: 300px;
        height: 300px;
    }

    .btn-create {
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        color: white;
        box-shadow: 0 5px 15px rgba(123, 44, 191, 0.4);
    }

    .btn-create:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 10px 25px rgba(123, 44, 191, 0.6);
        color: white;
    }

    .btn-export {
        background: var(--card-bg);
        border: var(--border);
        color: var(--text-primary);
    }

    .btn-export:hover {
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        color: white;
        border-color: transparent;
        transform: translateY(-3px);
    }

    .search-box {
        position: relative;
        min-width: 300px;
    }

    .search-box input {
        width: 100%;
        padding: 12px 20px 12px 45px;
        border-radius: 50px;
        border: var(--border);
        background: var(--card-bg);
        color: var(--text-primary);
        transition: var(--transition-smooth);
    }

    .search-box input:focus {
        border-color: var(--primary-pink);
        box-shadow: 0 0 0 0.2rem rgba(123, 44, 191, 0.25);
        transform: translateY(-2px);
        outline: none;
    }

    .search-box i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--primary-pink);
        font-size: 1.2rem;
    }

    /* Table Card */
    .table-card {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border: var(--border);
        border-radius: 20px;
        overflow: hidden;
        box-shadow: var(--shadow);
        transition: var(--transition-smooth);
        margin-bottom: 30px;
    }

    .table-card:hover {
        box-shadow: 0 15px 35px rgba(123, 44, 191, 0.2);
    }

    .table-header {
        padding: 20px 25px;
        border-bottom: var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(123, 44, 191, 0.05);
    }

    .table-header h3 {
        font-size: 1.2rem;
        font-weight: 600;
        margin: 0;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .table-header h3 i {
        color: var(--primary-pink);
    }

    .table-info {
        display: flex;
        align-items: center;
        gap: 10px;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .table-responsive {
        padding: 0;
    }

    .table {
        margin: 0;
        color: var(--text-primary);
    }

    .table thead th {
        background: rgba(123, 44, 191, 0.1);
        border: none;
        padding: 15px 20px;
        font-weight: 600;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--primary-pink);
    }

    .table tbody tr {
        transition: var(--transition-smooth);
        border-bottom: var(--border);
    }

    .table tbody tr:hover {
        background: rgba(123, 44, 191, 0.05);
        transform: scale(1.01);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .table tbody td {
        padding: 15px 20px;
        vertical-align: middle;
        border: none;
    }

    .assessment-type {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 500;
        background: rgba(123, 44, 191, 0.1);
        color: var(--primary-pink);
    }

    .badge-active {
        background: linear-gradient(135deg, #00b894, #00cec9);
        color: white;
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 500;
    }

    .badge-inactive {
        background: linear-gradient(135deg, #d63031, #e17055);
        color: white;
        padding: 5px 12px;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 500;
    }

    .weight-badge {
        display: inline-block;
        padding: 5px 12px;
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        color: white;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .btn-action-icon {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        color: var(--text-primary);
        background: rgba(123, 44, 191, 0.1);
        transition: var(--transition-bounce);
        border: none;
        cursor: pointer;
    }

    .btn-action-icon:hover {
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        color: white;
        transform: rotate(90deg);
    }

    .dropdown-menu {
        background: var(--card-bg);
        backdrop-filter: blur(10px);
        border: var(--border);
        border-radius: 15px;
        padding: 10px;
        box-shadow: var(--shadow);
        animation: fadeInDown 0.3s ease;
    }

    .dropdown-item {
        color: var(--text-primary);
        border-radius: 10px;
        padding: 8px 15px;
        transition: var(--transition-smooth);
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .dropdown-item i {
        width: 20px;
        color: var(--primary-pink);
    }

    .dropdown-item:hover {
        background: linear-gradient(135deg, var(--primary-pink), var(--dark-pink));
        color: white;
        transform: translateX(5px);
    }

    .dropdown-item:hover i {
        color: white;
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 60px 20px;
    }

    .empty-state-icon {
        width: 120px;
        height: 120px;
        line-height: 120px;
        text-align: center;
        background: linear-gradient(135deg, rgba(123, 44, 191, 0.1), rgba(74, 144, 226, 0.1));
        border-radius: 50%;
        margin: 0 auto 25px;
        font-size: 3rem;
        color: var(--primary-pink);
        animation: pulse 2s ease infinite;
    }

    .empty-state h4 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 10px;
        color: var(--text-primary);
    }

    .empty-state p {
        color: var(--text-secondary);
        margin-bottom: 25px;
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
    }

    @media (max-width: 768px) {
        .page-title { font-size: 2rem; }
        .action-bar { flex-direction: column; align-items: stretch; }
        .search-box { min-width: 100%; }
        .table thead th { font-size: 0.8rem; padding: 12px 10px; }
        .table tbody td { padding: 12px 10px; }
    }

    @media (max-width: 576px) {
        .page-header { padding: 30px 0; }
        .page-title { font-size: 1.8rem; }
        .filter-card { padding: 20px; }
        .action-buttons { flex-direction: column; }
        .btn-action { width: 100%; justify-content: center; }
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <h1 class="page-title animate__animated animate__fadeInDown">
            <i class="fas fa-clipboard-list me-3"></i>Assessment Management
        </h1>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb page-breadcrumb animate__animated animate__fadeInUp">
                <li class="breadcrumb-item"><a href="{% url 'accounts:admin_dashboard' %}">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="#">Academics</a></li>
                <li class="breadcrumb-item active" aria-current="page">Assessments</li>
            </ol>
        </nav>
    </div>
</section>

<div class="container">
    <!-- Filter Card -->
    <div class="filter-card animate__animated animate__fadeInUp">
        <div class="filter-title">
            <i class="fas fa-filter"></i>
            <span>Filter Assessments</span>
        </div>
        <form method="get" class="filter-form">
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="form-group">
                        <label><i class="fas fa-tag me-2"></i>Assessment Type</label>
                        <select name="type" class="form-select">
                            <option value="">All Types</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label><i class="fas fa-layer-group me-2"></i>Class Level</label>
                        <select name="class_level" class="form-select">
                            <option value="">All Levels</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label><i class="fas fa-toggle-on me-2"></i>Status</label>
                        <select name="status" class="form-select">
                            <option value="">All</option>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="filter-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-search me-2"></i>Apply Filters
                </button>
                <a href="#" class="btn btn-outline-primary">
                    <i class="fas fa-redo-alt me-2"></i>Reset
                </a>
            </div>
        </form>
    </div>

    <!-- Action Bar -->
    <div class="action-bar animate__animated animate__fadeInUp animate__delay-1s">
        <div class="action-buttons">
            <a href="#" class="btn-action btn-create">
                <i class="fas fa-plus-circle"></i>
                <span>Create New Assessment</span>
            </a>
            <button class="btn-action btn-export" onclick="exportTableToExcel()">
                <i class="fas fa-file-export"></i>
                <span>Export to Excel</span>
            </button>
            <button class="btn-action btn-export" onclick="window.print()">
                <i class="fas fa-print"></i>
                <span>Print</span>
            </button>
        </div>
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="tableSearch" placeholder="Search assessments..." class="form-control">
        </div>
    </div>

    <!-- Table Card -->
    <div class="table-card animate__animated animate__fadeInUp animate__delay-2s">
        <div class="table-header">
            <h3>
                <i class="fas fa-clipboard-check"></i>
                Assessment List
            </h3>
            <span class="table-info">
                <i class="fas fa-database"></i>
                Total: 12 assessments
            </span>
        </div>
        
        <div class="table-responsive">
            <table class="table" id="assessmentsTable">
                <thead>
                    <tr>
                        <th>Code</th>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Max Score</th>
                        <th>Weight</th>
                        <th>Class Level</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="assessment-row" data-assessment-id="1">
                        <td><span class="fw-bold">MTH-Q1-001</span></td>
                        <td>First Quarterly Test</td>
                        <td><span class="assessment-type"><i class="fas fa-pencil-alt me-1"></i>Test</span></td>
                        <td><span class="fw-bold">50</span></td>
                        <td><span class="weight-badge">20%</span></td>
                        <td>JSS 1</td>
                        <td><span class="badge-active"><i class="fas fa-check-circle me-1"></i>Active</span></td>
                        <td>
                            <div class="dropdown action-dropdown">
                                <button class="btn-action-icon" type="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-ellipsis-v"></i>
                                </button>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-edit"></i>Edit</a></li>
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-eye"></i>View</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-trash-alt"></i>Delete</a></li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="successToast" class="toast" role="alert">
        <div class="toast-header bg-success text-white">
            <i class="fas fa-check-circle me-2"></i>
            <strong class="me-auto">Success</strong>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body">Operation completed successfully!</div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('tableSearch').addEventListener('keyup', function() {
        const searchValue = this.value.toLowerCase();
        const tableRows = document.querySelectorAll('#assessmentsTable tbody tr');
        tableRows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchValue) ? '' : 'none';
        });
    });

    function exportTableToExcel() {
        const table = document.getElementById('assessmentsTable');
        const rows = table.querySelectorAll('tr');
        let csv = [];
        rows.forEach(row => {
            const cols = row.querySelectorAll('td, th');
            const rowData = [];
            cols.forEach((col, index) => {
                if (index < cols.length - 1) {
                    rowData.push('"' + col.innerText.replace(/"/g, '""') + '"');
                }
            });
            csv.push(rowData.join(','));
        });
        const csvContent = csv.join('\n');
        const blob = new Blob([csvContent], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'assessments.csv';
        a.click();
        window.URL.revokeObjectURL(url);
    }
</script>
{% endblock %}
